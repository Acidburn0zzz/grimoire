Index: mimetypes/CMakeLists.txt
===================================================================
--- mimetypes/CMakeLists.txt	(revision 1050788)
+++ mimetypes/CMakeLists.txt	(working copy)
@@ -5,4 +5,3 @@
 
 ########### install files ###############
 install(FILES kde.xml DESTINATION ${XDG_MIME_INSTALL_DIR})
-update_xdg_mimetypes(${XDG_MIME_INSTALL_DIR})
Index: solid/solid/CMakeLists.txt
===================================================================
--- solid/solid/CMakeLists.txt	(revision 1050788)
+++ solid/solid/CMakeLists.txt	(working copy)
@@ -107,6 +107,7 @@
 )
 
 if(NOT WIN32 AND NOT APPLE)
+ if(NOT DONT_USE_HAL)
    message(STATUS "-- Building Solid HAL backend." )
    set(solid_LIB_SRCS ${solid_LIB_SRCS}
 
@@ -135,6 +136,7 @@
    backends/hal/halsmartcardreader.cpp
 
    )
+ endif(NOT DONT_USE_HAL)
 endif(NOT WIN32 AND NOT APPLE)
 
 if(APPLE)
Index: solid/solid/managerbase.cpp
===================================================================
--- solid/solid/managerbase.cpp	(revision 1050788)
+++ solid/solid/managerbase.cpp	(working copy)
@@ -26,7 +26,9 @@
 #if defined (Q_OS_MAC)
 #include "backends/iokit/iokitmanager.h"
 #elif defined (Q_OS_UNIX)
+  #ifndef DONT_USE_HAL
 #include "backends/hal/halmanager.h"
+  #endif
 #elif defined (_MSC_VER) // TODO: mingw
 #include "backends/wmi/wmimanager.h"
 #endif
@@ -51,7 +53,9 @@
 #        if defined (Q_OS_MAC)
             m_backend = new Solid::Backends::IOKit::IOKitManager(0);
 #        elif defined (Q_OS_UNIX)
+  #ifndef DONT_USE_HAL
             m_backend = new Solid::Backends::Hal::HalManager(0);
+  #endif
 #        elif defined (_MSC_VER) // TODO: mingw
             m_backend = new Solid::Backends::Wmi::WmiManager(0);
 #        endif
