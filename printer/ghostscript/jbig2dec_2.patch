From 4b7b278daa5a8290681de6ad157060fb2e9068ea Mon Sep 17 00:00:00 2001
From: Chris Liddell <chris.liddell@artifex.com>
Date: Fri, 8 Jan 2016 15:42:30 +0000
Subject: [PATCH] Bug 696497 (part 2): fix support for building with a JPX
 decoder

---
 base/lib.mak | 3 +++
 psi/int.mak  | 3 +++
 2 files changed, 6 insertions(+)

diff --git a/base/lib.mak b/base/lib.mak
index 4d7db1f..a0a97cd 100644
--- a/base/lib.mak
+++ b/base/lib.mak
@@ -1774,6 +1774,9 @@ $(GLOBJ)sjpx.$(OBJ) : $(GLSRC)sjpx.c $(AK) \
  $(gdebug_h) $(strimpl_h) $(sjpx_h) $(MAKEDIRS)
 	$(GLJASCC) $(GLO_)sjpx.$(OBJ) $(C_) $(GLSRC)sjpx.c
 
+$(GLD)sjpx_.dev : $(LIB_MAK) $(ECHOGS_XE) $(LIB_MAK) $(MAKEDIRS)
+	$(SETMOD) $(GLD)sjpx_
+
 # luratech version
 sjpx_luratech=$(GLOBJ)sjpx_luratech.$(OBJ)
 $(GLD)sjpx_luratech.dev : $(LIB_MAK) $(ECHOGS_XE) \
diff --git a/psi/int.mak b/psi/int.mak
index 2c6d6d0..8b224ea 100644
--- a/psi/int.mak
+++ b/psi/int.mak
@@ -1291,6 +1291,9 @@ $(PSD)jpx.dev : $(ECHOGS_XE) $(PSD)jpx_$(JPX_LIB).dev\
  $(MAKEDIRS)
 	$(CP_) $(PSD)jpx_$(JPX_LIB).dev $(PSD)jpx.dev
 
+$(PSD)jpx_.dev : $(ECHOGS_XE) $(INT_MAK) $(MAKEDIRS)
+	$(SETMOD) $(PSD)jpx_
+
 fjpx_luratech=$(PSOBJ)zfjpx_luratech.$(OBJ)
 
 $(PSOBJ)zfjpx.$(OBJ) : $(PSSRC)zfjpx.c $(OP) $(memory__h)\
-- 
2.7.0

