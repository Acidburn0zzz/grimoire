local file UDEV_CFG="$INSTALL_ROOT/etc/udev" &&

install -m 755 -d "$INSTALL_ROOT/sys" \
                  "$UDEV_CFG/rules.d" &&

for file in $SPELL_DIRECTORY/rules/*; do
  install_config_file $file "$UDEV_CFG/rules.d/$(basename $file)"
done &&

# Aliases for modprobe
install -m 755 -d "$INSTALL_ROOT/etc/modprobe.d" &&

install_config_file "$SPELL_DIRECTORY/modprobe.aliases" \
                    "$INSTALL_ROOT/etc/modprobe.d/udev" &&

# These are used by devices init script, udev.conf also by udev
install_config_file "$SPELL_DIRECTORY/udev.conf" \
                    "$UDEV_CFG/udev.conf" &&

install_config_file "$SPELL_DIRECTORY/udev.missing" \
                    "$UDEV_CFG/udev.missing" &&

make DESTDIR="$INSTALL_ROOT/" $OPTS $UDEV_DEBUG \
     V=true EXTRAS="$_EXTRAS_TARG" install &&

# path_id helper is needed for persistent rules
install extras/path_id/path_id "$INSTALL_ROOT/lib/udev"
