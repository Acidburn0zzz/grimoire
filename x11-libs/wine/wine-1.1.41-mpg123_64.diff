--- configure.ac.orig	2010-03-19 19:02:16.000000000 +0000
+++ configure.ac	2010-03-22 15:59:20.255872817 +0000
@@ -1459,13 +1459,22 @@
                  [libpng ${notice_platform}development files not found, PNG won't be supported.])
 
 dnl **** Check for mpg123 ****
-if test "$ac_cv_header_mpg123_h" = "yes"
-then
-    AC_CHECK_LIB(mpg123,mpg123_feed,[AC_SUBST(LIBMPG123,"-lmpg123")])
-fi
-WINE_NOTICE_WITH(mpg123,[test "x$ac_cv_lib_mpg123_mpg123_feed" != xyes -a x"$ac_cv_header_CoreAudio_CoreAudio_h" != xyes],
-                 [libmpg123 ${notice_platform}development files not found (or too old), mp3 codec won't be supported.])
-test "x$ac_cv_lib_mpg123_mpg123_feed" = xyes -o "x$ac_cv_func_AudioFileStreamOpen" = xyes || enable_winemp3_acm=${enable_winemp3_acm:-no}
+dnl Because of the largefile mess, look out for both libmpg123_64 and libmpg123.
+dnl Note: One might also use pkg-config, both lib variants have defs for that.
+ if test "$ac_cv_header_mpg123_h" = "yes"
+ then
+    have_libmpg123=no
+    AC_CHECK_LIB(mpg123_64,mpg123_feed,[
+        AC_SUBST(LIBMPG123,"-lmpg123_64")
+        have_libmpg123=yes],
+        [
+            AC_CHECK_LIB(mpg123,mpg123_feed,[AC_SUBST(LIBMPG123,"-lmpg123")
+                have_libmpg123=yes])
+        ])
+ fi
+WINE_NOTICE_WITH(mpg123,[test "x$have_libmpg123" != xyes -a x"$ac_cv_header_CoreAudio_CoreAudio_h" != xyes],
+                  [libmpg123 ${notice_platform}development files not found (or too old), mp3 codec won't be supported.])
+test "x$have_libmpg123" = xyes -o "x$ac_cv_func_AudioFileStreamOpen" = xyes || enable_winemp3_acm=${enable_winemp3_acm:-no}
 
 dnl **** Check for OpenAL 1.1 ****
 if test "$ac_cv_header_AL_al_h" = "yes"
