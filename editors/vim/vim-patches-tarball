#!/bin/bash
# creates up-to-date vim patches tarball

VERSION=7.4

wget ftp://ftp.vim.org/pub/vim/patches/${VERSION}/MD5SUMS   &&
LAST=$(tail -n 1 MD5SUMS | cut -f 3 -d " " | cut -f 3 -d .) &&

SOURCE_DIRECTORY=vim-${VERSION}-patches-001-$LAST           &&
DISTFILE=vim-${VERSION}-patches-001-$LAST.tar.xz

mkdir $SOURCE_DIRECTORY &&
cd    $SOURCE_DIRECTORY &&

PATCHES=$(eval echo {001..$LAST}) &&

for i in $PATCHES; do
  wget ftp://ftp.vim.org/pub/vim/patches/${VERSION}/${VERSION}.$i
done &&

cd .. &&


tar cvf - $SOURCE_DIRECTORY | xz -9 > $DISTFILE &&

rm -r $SOURCE_DIRECTORY &&

sha512sum $DISTFILE
