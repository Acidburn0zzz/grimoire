. "$GRIMOIRE/FUNCTIONS" &&

depends dri2proto &&
depends libdrm &&
depends util-macros &&
depends gccmakedep &&
depends lndir &&
depends xorg-cf-files &&
depends makedepend &&
depends expat &&
depends libxdamage &&
depends libx11 &&
depends libxext &&
depends libxxf86vm &&
depends libxau &&
depends libxfixes &&
depends glproto &&
depends talloc &&
depends libxml2 &&
sub_depends libxml2 PYTHON &&

if list_find "$MESALIB_OPTS" "--enable-glw"; then
  depends libxt
fi &&

if list_find "$MESALIB_OPTS" "--enable-glu"; then
  optional_depends GLUT \
                   "--enable-glut" \
                   "--disable-glut" \
                   "to enable GLUT library"

  if is_depends_enabled $SPELL $(get_spell_provider $SPELL GLUT) ; then
    depends  libxi   &&
    depends  libxmu
  fi
fi &&

optional_depends libxcb \
                 '--enable-xcb' \
                 '--disable-xcb' \
                 'Enable XCB support?'

if is_depends_enabled $SPELL libxcb;then
  sub_depends libx11 XCB
fi &&

if spell_ok libdrm && is_version_less $(installed_version libdrm) 2.4.3; then
  force_depends libdrm
fi &&

if ( list_find "i915" $MESALIB_DRIVERS ) || \
   ( list_find "i965" $MESALIB_DRIVERS ); then
  sub_depends libdrm INTEL
fi &&

if ( list_find "r200" $MESALIB_DRIVERS ) || \
   ( list_find "r300" $MESALIB_DRIVERS ) || \
   ( list_find "r600" $MESALIB_DRIVERS ); then
  sub_depends libdrm RADEON
fi &&

if [[ $MESALIB_BRANCH == "scm" ]]; then
  depends  git
fi &&

if [[ "$MESALIB_BRANCH" == "development" && "$MESALIB_GALLIUM" != "none" ]]; then
  depends llvm
fi
