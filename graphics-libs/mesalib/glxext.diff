--- glxext.c.orig	2006-11-12 01:21:59.000000000 +0100
+++ glxext.c	2006-11-12 01:22:33.000000000 +0100
@@ -1016,11 +1016,11 @@
 	if (!_XReply(dpy, (xReply*) &reply, 0, False)) {
 	    /* Something is busted. Punt. */
 	    UnlockDisplay(dpy);
+	    SyncHandle();
 	    FreeScreenConfigs(priv);
 	    return GL_FALSE;
 	}
 
-	UnlockDisplay(dpy);
 	if (!reply.numVisuals) {
 	    /* This screen does not support GL rendering */
 	    UnlockDisplay(dpy);
