#
# From http://libtorrent.rakshasa.no/ticket/1266
#
[Libtorrent-devel] fix building with gcc 4.3 and above
Serge Belyshev belyshev at depni.sinp.msu.ru
Fri Feb 29 07:30:00 UTC 2008

    * Previous message: [Libtorrent-devel] Total incoming incorrect
    * Next message: [Libtorrent-devel] fix building rtorrent HEAD without xmlrpc
    * Messages sorted by: [ date ] [ thread ] [ subject ] [ author ]

In gcc 4.3 header dependencies were cleaned up, so libtorrent/rtorrent
do not build anymore. Fixed by the following patches, for libtorrent:

Index: libtorrent-0.12.0/rak/functional.h
===================================================================
--- libtorrent-0.12.0.orig/rak/functional.h
+++ libtorrent-0.12.0/rak/functional.h
@@ -37,6 +37,7 @@
 #ifndef RAK_FUNCTIONAL_H
 #define RAK_FUNCTIONAL_H
 
+#include <stddef.h>
 #include <functional>
 
 namespace rak {
Index: libtorrent-0.12.0/src/data/chunk.cc
===================================================================
--- libtorrent-0.12.0.orig/src/data/chunk.cc
+++ libtorrent-0.12.0/src/data/chunk.cc
@@ -38,6 +38,7 @@
 
 #include <algorithm>
 #include <functional>
+#include <cstring>
 
 #include "torrent/exceptions.h"
 
Index: libtorrent-0.12.0/src/data/chunk_list.h
===================================================================
--- libtorrent-0.12.0.orig/src/data/chunk_list.h
+++ libtorrent-0.12.0/src/data/chunk_list.h
@@ -38,6 +38,7 @@
 #define LIBTORRENT_DATA_CHUNK_LIST_H
 
 #include <vector>
+#include <string>
 #include <rak/error_number.h>
 #include <rak/functional.h>
 
Index: libtorrent-0.12.0/src/net/address_list.cc
===================================================================
--- libtorrent-0.12.0.orig/src/net/address_list.cc
+++ libtorrent-0.12.0/src/net/address_list.cc
@@ -37,6 +37,7 @@
 #include "config.h"
 
 #include <rak/functional.h>
+#include <algorithm>
 
 #include "download/download_info.h"  // for SocketAddressCompact
 
Index: libtorrent-0.12.0/src/torrent/data/file_list.h
===================================================================
--- libtorrent-0.12.0.orig/src/torrent/data/file_list.h
+++ libtorrent-0.12.0/src/torrent/data/file_list.h
@@ -38,6 +38,7 @@
 #define LIBTORRENT_FILE_LIST_H
 
 #include <vector>
+#include <cstdlib>
 #include <torrent/common.h>
 #include <torrent/bitfield.h>
 #include <torrent/path.h>
Index: libtorrent-0.12.0/src/torrent/exceptions.cc
===================================================================
--- libtorrent-0.12.0.orig/src/torrent/exceptions.cc
+++ libtorrent-0.12.0/src/torrent/exceptions.cc
@@ -37,6 +37,7 @@
 #include "config.h"
 
 #include <cerrno>
+#include <cstring>
 
 #include "exceptions.h"
 
Index: libtorrent-0.12.0/src/torrent/tracker_list.h
===================================================================
--- libtorrent-0.12.0.orig/src/torrent/tracker_list.h
+++ libtorrent-0.12.0/src/torrent/tracker_list.h
@@ -40,6 +40,7 @@
 #include <algorithm>
 #include <vector>
 #include <torrent/common.h>
+#include <string>
 
 namespace torrent {
 
Index: libtorrent-0.12.0/src/utils/diffie_hellman.cc
===================================================================
--- libtorrent-0.12.0.orig/src/utils/diffie_hellman.cc
+++ libtorrent-0.12.0/src/utils/diffie_hellman.cc
@@ -37,6 +37,7 @@
 #include "config.h"
 
 #include <string>
+#include <cstring>
 
 #ifdef USE_OPENSSL
 #include <openssl/bn.h>

