cd "$SOURCE_DIRECTORY/hostapd" &&

local VARS="CONFIG_DEBUG_FILE CONFIG_DRIVER_HOSTAP CONFIG_DRIVER_NL80211 \
            CONFIG_DRIVER_NONE CONFIG_DRIVER_RADIUS_ACL CONFIG_DRIVER_WIRED \
            CONFIG_EAP CONFIG_EAP_AKA CONFIG_EAP_AKA_PRIME CONFIG_EAP_GPSK \
            CONFIG_EAP_GPSK_SHA256 CONFIG_EAP_GTC CONFIG_EAP_IKEV2 \
            CONFIG_EAP_MD5 CONFIG_EAP_MSCHAPV2 CONFIG_EAP_PAX CONFIG_EAP_PEAP \
            CONFIG_EAP_PSK CONFIG_EAP_PWD CONFIG_EAP_SAKE CONFIG_EAP_SIM \
            CONFIG_EAP_TLS CONFIG_EAP_TNC CONFIG_EAP_TTLS \
            CONFIG_FULL_DYNAMIC_VLAN CONFIG_IAPP CONFIG_IEEE80211N \
            CONFIG_IEEE80211R CONFIG_IEEE80211W CONFIG_INTERWORKING CONFIG_IPV6 \
            CONFIG_LIBNL32 CONFIG_NO_ACCOUNTING CONFIG_NO_DUMP_STATE \
            CONFIG_NO_RADIUS CONFIG_NO_RANDOM_POOL CONFIG_NO_STDOUT_DEBUG \
            CONFIG_NO_VLAN CONFIG_PEERKEY CONFIG_PKCS12 CONFIG_RADIUS_SERVER \
            CONFIG_RSN_PREAUTH CONFIG_WPA_TRACE CONFIG_WPS CONFIG_WPS2 \
            CONFIG_WPS_UPNP" &&

# TLS support
VARS="CONFIG_TLS CONFIG_TLSV11 $VARS" &&

# untested
#if [[ $CONFIG_DRIVER_MADWIFI == y ]]; then
#  VARS="CONFIG_DRIVER_MADWIFI $VARS" &&
#  echo "CFLAGS += -I/usr/include/madwifi" >> .config
#fi &&

if [[ $CONFIG_DRIVER_NL80211 == y ]]; then
  persistent_add CONFIG_LIBNL32 &&
  CONFIG_LIBNL32=y &&
  echo "CFLAGS += -I$INSTALL_ROOT/usr/include/libnl3" >> .config
fi &&

# Create .config file for make
for v in $VARS; do
  if [[ -n ${!v} && ${!v} != n ]]; then
    echo "$v=${!v:-y}" >> .config
  fi
done &&

# Print config for sorcery compile log
cat .config &&

make
