diff -u libxml2-2.7.8.dfsg/xpointer.c libxml2-2.7.8.dfsg/xpointer.c
--- libxml2-2.7.8.dfsg/xpointer.c
+++ libxml2-2.7.8.dfsg/xpointer.c
@@ -1007,21 +1007,14 @@
    NEXT;
    break;
      }
-     *cur++ = CUR;
  } else if (CUR == '(') {
      level++;
-     *cur++ = CUR;
  } else if (CUR == '^') {
-     NEXT;
-     if ((CUR == ')') || (CUR == '(') || (CUR == '^')) {
-   *cur++ = CUR;
-     } else {
-   *cur++ = '^';
-   *cur++ = CUR;
-     }
- } else {
-     *cur++ = CUR;
+            if ((NXT(1) == ')') || (NXT(1) == '(') || (NXT(1) == '^')) {
+                NEXT;
+            }
  }
+        *cur++ = CUR;
  NEXT;
     }
     *cur = 0;
